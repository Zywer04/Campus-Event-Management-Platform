# 社团申报活动在审核页面不显示 - 问题排查指南

## 问题描述
社团申报的活动在管理员的审核活动页面不显示。

## 可能的原因和解决方案

### 1. 检查后端服务是否正常运行

**检查方法**：
```bash
# 检查后端服务是否启动
curl http://localhost:8000/api/get-all-activities
```

**解决方案**：
- 如果服务未启动，运行 `start_system.bat` 或 `start_system.sh`
- 检查后端控制台是否有错误信息

### 2. 检查数据库中是否有活动数据

**检查方法**：
```bash
# 运行调试脚本
python debug_activities.py
```

**解决方案**：
- 如果数据库中没有活动，需要先创建测试活动
- 确保社团申报活动时状态正确设置为"审核中"

### 3. 检查权限问题

**检查方法**：
1. 确保使用管理员账号登录
2. 检查浏览器控制台是否有403错误
3. 检查localStorage中是否有有效的token

**解决方案**：
- 重新注册管理员账号
- 清除浏览器缓存和localStorage
- 重新登录

### 4. 检查API接口

**检查方法**：
```bash
# 测试新的待审核活动接口
curl -H "Authorization: Bearer YOUR_ADMIN_TOKEN" http://localhost:8000/api/get-pending-activities
```

**解决方案**：
- 确保使用新的 `/api/get-pending-activities` 接口
- 检查token是否正确传递

### 5. 检查前端代码

**检查方法**：
1. 打开浏览器开发者工具
2. 查看Network标签页
3. 检查API请求是否成功
4. 查看Console标签页是否有错误

**解决方案**：
- 检查AuditPage.tsx中的状态筛选逻辑
- 确保默认状态设置为"审核中"

## 完整的测试流程

### 步骤1：启动系统
```bash
# Windows
start_system.bat

# Linux/Mac
./start_system.sh
```

### 步骤2：运行完整测试
```bash
python test_club_activity.py
```

### 步骤3：手动测试
1. 注册社团账号
2. 申报活动
3. 注册管理员账号
4. 访问审核页面
5. 检查是否显示待审核活动

## 调试工具

### 1. 调试脚本
```bash
python debug_activities.py
```

### 2. 浏览器调试
- 打开开发者工具 (F12)
- 查看Network标签页
- 查看Console标签页
- 检查localStorage中的token

### 3. 后端日志
- 查看后端控制台输出
- 检查是否有错误信息
- 查看API请求日志

## 常见错误和解决方案

### 错误1：403 Forbidden
**原因**：权限不足
**解决**：确保使用管理员账号登录

### 错误2：500 Internal Server Error
**原因**：后端服务错误
**解决**：检查后端日志，重启服务

### 错误3：Network Error
**原因**：网络连接问题
**解决**：检查后端服务是否启动

### 错误4：空的活动列表
**原因**：数据库中没有活动数据
**解决**：先创建测试活动

## 验证步骤

### 1. 验证后端API
```bash
# 测试获取所有活动
curl http://localhost:8000/api/get-all-activities

# 测试获取待审核活动（需要管理员token）
curl -H "Authorization: Bearer YOUR_TOKEN" http://localhost:8000/api/get-pending-activities
```

### 2. 验证前端页面
1. 访问 http://localhost:5173
2. 注册社团账号并申报活动
3. 注册管理员账号并访问审核页面
4. 检查是否显示待审核活动

### 3. 验证数据库
```bash
# 运行调试脚本检查数据库
python debug_activities.py
```

## 联系支持

如果按照以上步骤仍然无法解决问题，请提供以下信息：

1. 后端控制台错误信息
2. 浏览器控制台错误信息
3. 调试脚本的输出结果
4. 具体的操作步骤

## 预防措施

1. **定期备份数据**：重要操作前备份数据库
2. **测试环境**：在测试环境中先验证功能
3. **日志记录**：启用详细的日志记录
4. **错误处理**：完善前端的错误处理机制 